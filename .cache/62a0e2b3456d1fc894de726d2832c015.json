{"id":"app/stores/ePubStore.js","dependencies":[{"name":"/Users/nick/projects/personal/package.json","includedInParent":true,"mtime":1535748651942},{"name":"/Users/nick/projects/personal/.babelrc","includedInParent":true,"mtime":1535748626225},{"name":"../lib/book","loc":{"line":1,"column":24},"parent":"/Users/nick/projects/personal/app/stores/ePubStore.js","resolved":"/Users/nick/projects/personal/app/lib/book.js"},{"name":"mobx","loc":{"line":2,"column":27},"parent":"/Users/nick/projects/personal/app/stores/ePubStore.js","resolved":"/Users/nick/projects/personal/node_modules/mobx/lib/mobx.module.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _desc, _value, _class, _descriptor;\n\nvar _book = require(\"../lib/book\");\n\nvar _mobx = require(\"mobx\");\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _initDefineProp(target, property, descriptor, context) {\n  if (!descriptor) return;\n  Object.defineProperty(target, property, {\n    enumerable: descriptor.enumerable,\n    configurable: descriptor.configurable,\n    writable: descriptor.writable,\n    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0\n  });\n}\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n  var desc = {};\n  Object['ke' + 'ys'](descriptor).forEach(function (key) {\n    desc[key] = descriptor[key];\n  });\n  desc.enumerable = !!desc.enumerable;\n  desc.configurable = !!desc.configurable;\n\n  if ('value' in desc || desc.initializer) {\n    desc.writable = true;\n  }\n\n  desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n    return decorator(target, property, desc) || desc;\n  }, desc);\n\n  if (context && desc.initializer !== void 0) {\n    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n    desc.initializer = undefined;\n  }\n\n  if (desc.initializer === void 0) {\n    Object['define' + 'Property'](target, property, desc);\n    desc = null;\n  }\n\n  return desc;\n}\n\nfunction _initializerWarningHelper(descriptor, context) {\n  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');\n}\n\nvar EPubStore = (_class = function EPubStore(_ref) {\n  var _this = this;\n\n  var url = _ref.url;\n\n  _classCallCheck(this, EPubStore);\n\n  this.url = null;\n\n  _initDefineProp(this, \"loaded\", _descriptor, this);\n\n  this.start = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n    var base, downloadUrl, book, meta;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            base = Settings.apiBase + \"/download?url=\";\n            downloadUrl = base + _this.url;\n            _context2.next = 4;\n            return (0, _book.getBook)(downloadUrl);\n\n          case 4:\n            book = _context2.sent;\n            _context2.next = 7;\n            return book.loaded.navigation;\n\n          case 7:\n            _this.toc = _context2.sent;\n            _context2.next = 10;\n            return book.loaded.metadata;\n\n          case 10:\n            meta = _context2.sent;\n\n            _this.title = meta.title;\n            _this.book = book;\n\n            _context2.next = 15;\n            return Promise.all(book.spine.spineItems\n            // .slice(0, 12)\n            .map(function () {\n              var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(item) {\n                return regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.next = 2;\n                        return item.load(book.load.bind(book));\n\n                      case 2:\n                        return _context.abrupt(\"return\", _context.sent);\n\n                      case 3:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee, _this);\n              }));\n\n              return function (_x) {\n                return _ref3.apply(this, arguments);\n              };\n            }()));\n\n          case 15:\n            _this.chapters = _context2.sent;\n\n\n            _this.loaded = true;\n\n            return _context2.abrupt(\"return\", true);\n\n          case 18:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, _this);\n  }));\n\n  this.getChapter = function (index) {\n    return Array.from(_this.chapters[index].querySelectorAll(\"p\")).map(function (el) {\n      return el.textContent;\n    }).filter(function (text) {\n      return text.trim().length > 0;\n    });\n  };\n\n  this.url = url;\n}, (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"loaded\", [_mobx.observable], {\n  enumerable: true,\n  initializer: function initializer() {\n    return false;\n  }\n})), _class);\nexports.default = EPubStore;","map":{"mappings":[{"generated":{"line":10,"column":0},"source":"app/stores/ePubStore.js","original":{"line":1,"column":0}},{"generated":{"line":12,"column":0},"source":"app/stores/ePubStore.js","original":{"line":2,"column":0}},{"name":"EPubStore","generated":{"line":61,"column":4},"source":"app/stores/ePubStore.js","original":{"line":4,"column":21}},{"generated":{"line":61,"column":26},"source":"app/stores/ePubStore.js","original":{"line":37,"column":2}},{"generated":{"line":61,"column":51},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":62,"column":0},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":64,"column":0},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"name":"url","generated":{"line":64,"column":6},"source":"app/stores/ePubStore.js","original":{"line":37,"column":16}},{"generated":{"line":64,"column":9},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"name":"url","generated":{"line":64,"column":17},"source":"app/stores/ePubStore.js","original":{"line":37,"column":16}},{"generated":{"line":64,"column":20},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":66,"column":0},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":68,"column":0},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"name":"url","generated":{"line":68,"column":7},"source":"app/stores/ePubStore.js","original":{"line":5,"column":2}},{"generated":{"line":68,"column":10},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":68,"column":13},"source":"app/stores/ePubStore.js","original":{"line":5,"column":8}},{"generated":{"line":68,"column":17},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":70,"column":0},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":72,"column":0},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"name":"start","generated":{"line":72,"column":7},"source":"app/stores/ePubStore.js","original":{"line":10,"column":2}},{"generated":{"line":72,"column":12},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":72,"column":71},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":73,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":74,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":75,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":76,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":77,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"name":"base","generated":{"line":78,"column":0},"source":"app/stores/ePubStore.js","original":{"line":11,"column":10}},{"generated":{"line":78,"column":16},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"name":"Settings","generated":{"line":78,"column":19},"source":"app/stores/ePubStore.js","original":{"line":11,"column":20}},{"name":"apiBase","generated":{"line":78,"column":28},"source":"app/stores/ePubStore.js","original":{"line":11,"column":29}},{"generated":{"line":78,"column":35},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"name":"downloadUrl","generated":{"line":79,"column":0},"source":"app/stores/ePubStore.js","original":{"line":12,"column":10}},{"generated":{"line":79,"column":23},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"name":"base","generated":{"line":79,"column":26},"source":"app/stores/ePubStore.js","original":{"line":12,"column":24}},{"generated":{"line":79,"column":33},"source":"app/stores/ePubStore.js","original":{"line":12,"column":31}},{"name":"url","generated":{"line":79,"column":39},"source":"app/stores/ePubStore.js","original":{"line":12,"column":36}},{"generated":{"line":79,"column":42},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":80,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":81,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":81,"column":19},"source":"app/stores/ePubStore.js","original":{"line":14,"column":23}},{"name":"downloadUrl","generated":{"line":81,"column":38},"source":"app/stores/ePubStore.js","original":{"line":14,"column":31}},{"generated":{"line":81,"column":49},"source":"app/stores/ePubStore.js","original":{"line":14,"column":23}},{"generated":{"line":81,"column":50},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":83,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"name":"book","generated":{"line":84,"column":0},"source":"app/stores/ePubStore.js","original":{"line":14,"column":10}},{"generated":{"line":84,"column":16},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":85,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":86,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"name":"book","generated":{"line":86,"column":19},"source":"app/stores/ePubStore.js","original":{"line":15,"column":21}},{"name":"loaded","generated":{"line":86,"column":24},"source":"app/stores/ePubStore.js","original":{"line":15,"column":26}},{"generated":{"line":86,"column":30},"source":"app/stores/ePubStore.js","original":{"line":15,"column":21}},{"name":"navigation","generated":{"line":86,"column":31},"source":"app/stores/ePubStore.js","original":{"line":15,"column":33}},{"generated":{"line":86,"column":41},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":88,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":89,"column":0},"source":"app/stores/ePubStore.js","original":{"line":15,"column":4}},{"name":"toc","generated":{"line":89,"column":18},"source":"app/stores/ePubStore.js","original":{"line":15,"column":9}},{"generated":{"line":89,"column":21},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":90,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":91,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"name":"book","generated":{"line":91,"column":19},"source":"app/stores/ePubStore.js","original":{"line":16,"column":23}},{"name":"loaded","generated":{"line":91,"column":24},"source":"app/stores/ePubStore.js","original":{"line":16,"column":28}},{"generated":{"line":91,"column":30},"source":"app/stores/ePubStore.js","original":{"line":16,"column":23}},{"name":"metadata","generated":{"line":91,"column":31},"source":"app/stores/ePubStore.js","original":{"line":16,"column":35}},{"generated":{"line":91,"column":39},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":93,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"name":"meta","generated":{"line":94,"column":0},"source":"app/stores/ePubStore.js","original":{"line":16,"column":10}},{"generated":{"line":94,"column":16},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":96,"column":0},"source":"app/stores/ePubStore.js","original":{"line":17,"column":4}},{"name":"title","generated":{"line":96,"column":18},"source":"app/stores/ePubStore.js","original":{"line":17,"column":9}},{"generated":{"line":96,"column":23},"source":"app/stores/ePubStore.js","original":{"line":17,"column":4}},{"name":"meta","generated":{"line":96,"column":26},"source":"app/stores/ePubStore.js","original":{"line":17,"column":17}},{"name":"title","generated":{"line":96,"column":31},"source":"app/stores/ePubStore.js","original":{"line":17,"column":22}},{"generated":{"line":96,"column":36},"source":"app/stores/ePubStore.js","original":{"line":17,"column":4}},{"generated":{"line":97,"column":0},"source":"app/stores/ePubStore.js","original":{"line":18,"column":4}},{"name":"book","generated":{"line":97,"column":18},"source":"app/stores/ePubStore.js","original":{"line":18,"column":9}},{"generated":{"line":97,"column":22},"source":"app/stores/ePubStore.js","original":{"line":18,"column":4}},{"name":"book","generated":{"line":97,"column":25},"source":"app/stores/ePubStore.js","original":{"line":18,"column":16}},{"generated":{"line":97,"column":29},"source":"app/stores/ePubStore.js","original":{"line":18,"column":4}},{"generated":{"line":99,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":100,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"name":"Promise","generated":{"line":100,"column":19},"source":"app/stores/ePubStore.js","original":{"line":20,"column":26}},{"name":"all","generated":{"line":100,"column":27},"source":"app/stores/ePubStore.js","original":{"line":20,"column":34}},{"generated":{"line":100,"column":30},"source":"app/stores/ePubStore.js","original":{"line":20,"column":26}},{"name":"book","generated":{"line":100,"column":31},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"name":"spine","generated":{"line":100,"column":36},"source":"app/stores/ePubStore.js","original":{"line":21,"column":11}},{"generated":{"line":100,"column":41},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"name":"spineItems","generated":{"line":100,"column":42},"source":"app/stores/ePubStore.js","original":{"line":21,"column":17}},{"generated":{"line":101,"column":0},"source":"app/stores/ePubStore.js","original":{"line":22,"column":8}},{"generated":{"line":102,"column":0},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"name":"map","generated":{"line":102,"column":13},"source":"app/stores/ePubStore.js","original":{"line":23,"column":9}},{"generated":{"line":102,"column":16},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"generated":{"line":103,"column":0},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"generated":{"line":103,"column":82},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"name":"item","generated":{"line":103,"column":99},"source":"app/stores/ePubStore.js","original":{"line":23,"column":19}},{"generated":{"line":103,"column":103},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":104,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":105,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":106,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":107,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":108,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":109,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"name":"item","generated":{"line":109,"column":31},"source":"app/stores/ePubStore.js","original":{"line":23,"column":33}},{"name":"load","generated":{"line":109,"column":36},"source":"app/stores/ePubStore.js","original":{"line":23,"column":38}},{"generated":{"line":109,"column":40},"source":"app/stores/ePubStore.js","original":{"line":23,"column":33}},{"name":"book","generated":{"line":109,"column":41},"source":"app/stores/ePubStore.js","original":{"line":23,"column":43}},{"name":"load","generated":{"line":109,"column":46},"source":"app/stores/ePubStore.js","original":{"line":23,"column":48}},{"generated":{"line":109,"column":50},"source":"app/stores/ePubStore.js","original":{"line":23,"column":43}},{"name":"bind","generated":{"line":109,"column":51},"source":"app/stores/ePubStore.js","original":{"line":23,"column":53}},{"generated":{"line":109,"column":55},"source":"app/stores/ePubStore.js","original":{"line":23,"column":43}},{"name":"book","generated":{"line":109,"column":56},"source":"app/stores/ePubStore.js","original":{"line":23,"column":58}},{"generated":{"line":109,"column":60},"source":"app/stores/ePubStore.js","original":{"line":23,"column":43}},{"generated":{"line":109,"column":61},"source":"app/stores/ePubStore.js","original":{"line":23,"column":33}},{"generated":{"line":109,"column":62},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":111,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":112,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":114,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":115,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":116,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":117,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":118,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":119,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":120,"column":0},"source":"app/stores/ePubStore.js","original":{"line":23,"column":13}},{"generated":{"line":120,"column":15},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"generated":{"line":122,"column":0},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"generated":{"line":123,"column":0},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"generated":{"line":124,"column":0},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"generated":{"line":125,"column":0},"source":"app/stores/ePubStore.js","original":{"line":21,"column":6}},{"generated":{"line":125,"column":16},"source":"app/stores/ePubStore.js","original":{"line":20,"column":26}},{"generated":{"line":125,"column":17},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":127,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":128,"column":0},"source":"app/stores/ePubStore.js","original":{"line":20,"column":4}},{"name":"chapters","generated":{"line":128,"column":18},"source":"app/stores/ePubStore.js","original":{"line":20,"column":9}},{"generated":{"line":128,"column":26},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":131,"column":0},"source":"app/stores/ePubStore.js","original":{"line":26,"column":4}},{"name":"loaded","generated":{"line":131,"column":18},"source":"app/stores/ePubStore.js","original":{"line":26,"column":9}},{"generated":{"line":131,"column":24},"source":"app/stores/ePubStore.js","original":{"line":26,"column":4}},{"generated":{"line":131,"column":27},"source":"app/stores/ePubStore.js","original":{"line":26,"column":18}},{"generated":{"line":131,"column":31},"source":"app/stores/ePubStore.js","original":{"line":26,"column":4}},{"generated":{"line":133,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":133,"column":46},"source":"app/stores/ePubStore.js","original":{"line":28,"column":11}},{"generated":{"line":133,"column":50},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":135,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":136,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":137,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":138,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":139,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":140,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":141,"column":0},"source":"app/stores/ePubStore.js","original":{"line":10,"column":10}},{"generated":{"line":141,"column":3},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":143,"column":0},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"name":"getChapter","generated":{"line":143,"column":7},"source":"app/stores/ePubStore.js","original":{"line":31,"column":2}},{"generated":{"line":143,"column":17},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":143,"column":20},"source":"app/stores/ePubStore.js","original":{"line":31,"column":15}},{"generated":{"line":143,"column":37},"source":"app/stores/ePubStore.js","original":{"line":31,"column":24}},{"generated":{"line":144,"column":0},"source":"app/stores/ePubStore.js","original":{"line":32,"column":4}},{"name":"Array","generated":{"line":144,"column":11},"source":"app/stores/ePubStore.js","original":{"line":32,"column":11}},{"name":"from","generated":{"line":144,"column":17},"source":"app/stores/ePubStore.js","original":{"line":32,"column":17}},{"generated":{"line":144,"column":21},"source":"app/stores/ePubStore.js","original":{"line":32,"column":11}},{"generated":{"line":144,"column":22},"source":"app/stores/ePubStore.js","original":{"line":32,"column":22}},{"name":"chapters","generated":{"line":144,"column":28},"source":"app/stores/ePubStore.js","original":{"line":32,"column":27}},{"generated":{"line":144,"column":36},"source":"app/stores/ePubStore.js","original":{"line":32,"column":22}},{"name":"index","generated":{"line":144,"column":37},"source":"app/stores/ePubStore.js","original":{"line":32,"column":36}},{"generated":{"line":144,"column":42},"source":"app/stores/ePubStore.js","original":{"line":32,"column":22}},{"name":"querySelectorAll","generated":{"line":144,"column":44},"source":"app/stores/ePubStore.js","original":{"line":32,"column":43}},{"generated":{"line":144,"column":60},"source":"app/stores/ePubStore.js","original":{"line":32,"column":22}},{"generated":{"line":144,"column":61},"source":"app/stores/ePubStore.js","original":{"line":32,"column":60}},{"generated":{"line":144,"column":64},"source":"app/stores/ePubStore.js","original":{"line":32,"column":22}},{"generated":{"line":144,"column":65},"source":"app/stores/ePubStore.js","original":{"line":32,"column":11}},{"name":"map","generated":{"line":144,"column":67},"source":"app/stores/ePubStore.js","original":{"line":33,"column":7}},{"generated":{"line":144,"column":70},"source":"app/stores/ePubStore.js","original":{"line":32,"column":11}},{"generated":{"line":144,"column":71},"source":"app/stores/ePubStore.js","original":{"line":33,"column":11}},{"generated":{"line":145,"column":0},"source":"app/stores/ePubStore.js","original":{"line":33,"column":11}},{"name":"el","generated":{"line":145,"column":13},"source":"app/stores/ePubStore.js","original":{"line":33,"column":17}},{"name":"textContent","generated":{"line":145,"column":16},"source":"app/stores/ePubStore.js","original":{"line":33,"column":20}},{"generated":{"line":145,"column":27},"source":"app/stores/ePubStore.js","original":{"line":33,"column":11}},{"generated":{"line":146,"column":0},"source":"app/stores/ePubStore.js","original":{"line":33,"column":11}},{"generated":{"line":146,"column":5},"source":"app/stores/ePubStore.js","original":{"line":32,"column":11}},{"name":"filter","generated":{"line":146,"column":7},"source":"app/stores/ePubStore.js","original":{"line":34,"column":7}},{"generated":{"line":146,"column":13},"source":"app/stores/ePubStore.js","original":{"line":32,"column":11}},{"generated":{"line":146,"column":14},"source":"app/stores/ePubStore.js","original":{"line":34,"column":14}},{"generated":{"line":147,"column":0},"source":"app/stores/ePubStore.js","original":{"line":34,"column":14}},{"name":"text","generated":{"line":147,"column":13},"source":"app/stores/ePubStore.js","original":{"line":34,"column":22}},{"name":"trim","generated":{"line":147,"column":18},"source":"app/stores/ePubStore.js","original":{"line":34,"column":27}},{"generated":{"line":147,"column":22},"source":"app/stores/ePubStore.js","original":{"line":34,"column":22}},{"name":"length","generated":{"line":147,"column":25},"source":"app/stores/ePubStore.js","original":{"line":34,"column":34}},{"generated":{"line":147,"column":31},"source":"app/stores/ePubStore.js","original":{"line":34,"column":22}},{"generated":{"line":147,"column":34},"source":"app/stores/ePubStore.js","original":{"line":34,"column":43}},{"generated":{"line":147,"column":35},"source":"app/stores/ePubStore.js","original":{"line":34,"column":14}},{"generated":{"line":148,"column":0},"source":"app/stores/ePubStore.js","original":{"line":34,"column":14}},{"generated":{"line":148,"column":5},"source":"app/stores/ePubStore.js","original":{"line":32,"column":11}},{"generated":{"line":148,"column":6},"source":"app/stores/ePubStore.js","original":{"line":32,"column":4}},{"generated":{"line":149,"column":0},"source":"app/stores/ePubStore.js","original":{"line":35,"column":3}},{"generated":{"line":149,"column":3},"source":"app/stores/ePubStore.js","original":{"line":37,"column":23}},{"generated":{"line":151,"column":0},"source":"app/stores/ePubStore.js","original":{"line":38,"column":4}},{"name":"url","generated":{"line":151,"column":7},"source":"app/stores/ePubStore.js","original":{"line":38,"column":9}},{"generated":{"line":151,"column":10},"source":"app/stores/ePubStore.js","original":{"line":38,"column":4}},{"name":"url","generated":{"line":151,"column":13},"source":"app/stores/ePubStore.js","original":{"line":38,"column":15}},{"generated":{"line":151,"column":16},"source":"app/stores/ePubStore.js","original":{"line":38,"column":4}},{"generated":{"line":152,"column":0},"source":"app/stores/ePubStore.js","original":{"line":39,"column":3}},{"name":"observable","generated":{"line":152,"column":73},"source":"app/stores/ePubStore.js","original":{"line":7,"column":3}},{"generated":{"line":155,"column":11},"source":"app/stores/ePubStore.js","original":{"line":8,"column":11}},{"name":"EPubStore","generated":{"line":158,"column":18},"source":"app/stores/ePubStore.js","original":{"line":4,"column":21}}],"sources":{"app/stores/ePubStore.js":"import { getBook } from \"../lib/book\"\nimport { observable } from \"mobx\"\n\nexport default class EPubStore {\n  url = null\n\n  @observable\n  loaded = false\n\n  start = async () => {\n    const base = `${Settings.apiBase}/download?url=`\n    const downloadUrl = base + this.url\n\n    const book = await getBook(downloadUrl)\n    this.toc = await book.loaded.navigation\n    const meta = await book.loaded.metadata\n    this.title = meta.title\n    this.book = book\n\n    this.chapters = await Promise.all(\n      book.spine.spineItems\n        // .slice(0, 12)\n        .map(async item => await item.load(book.load.bind(book))),\n    )\n\n    this.loaded = true\n\n    return true\n  }\n\n  getChapter = index => {\n    return Array.from(this.chapters[index].querySelectorAll(\"p\"))\n      .map(el => el.textContent)\n      .filter(text => text.trim().length > 0)\n  }\n\n  constructor({ url }) {\n    this.url = url\n  }\n}\n"},"lineCount":null}},"hash":"fa0d35133eebb4fe86ba100af9730ccb","cacheData":{"env":{}}}